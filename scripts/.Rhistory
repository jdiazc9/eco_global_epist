name = '') +
scale_alpha_manual(values = c(rep(1, 8), 0.05),
guide = 'none') +
scale_size_manual(values = c(rep(3, 8), 1),
guide = 'none') +
scale_x_continuous(name = 'FEE intercept [a.u.]',
breaks = pretty_breaks(n = 3)) +
scale_y_continuous(name = 'FEE slope',
breaks = pretty_breaks(n = 3)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank()) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
print(myplot)
ggsave(myplot,
filename = '../plots/figS4_1.pdf',
device = 'pdf',
dpi = 600,
width = 160,
height = 80,
units = 'mm',
limitsize = F)
# plot histograms of R^2 pred vs. obs
r <- data.frame(run = c(rep('True data', length(rsq)), rep('Randomized data', length(rsq.rnd))),
rsq = c(rsq, rsq.rnd))
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram()
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(breaks = 50)
?geom_histogram
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50)
r$run <- factor(r$run, levels = c('True data', 'Randomized data'))
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50)
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50) +
scale_fill_manual(values = c('firebrick1', 'black'))
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50) +
scale_fill_manual(values = c('white', 'black'),
name = '')
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('white', 'black'),
name = '')
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '')
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, 'predicted vs. observed')))
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1'))
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
#axis.ticks.y = element_blank(),
#axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = 'Frequency',
expand = c(0,1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
#axis.ticks.y = element_blank(),
#axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = 'Frequency',
expand = c(1, 0)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = 'Frequency',
expand = c(0, 0)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = 'Frequency',
expand = c(0, 0.2)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = 'Frequency',
expand = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = 'Frequency',
expand = expansion(mult = c(0, .1))) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = 'Frequency',
expand = expansion(mult = c(0, .1))) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.text = element_text(size = 14)) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
myplot <-
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(R^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = 'Frequency',
expand = expansion(mult = c(0, .1))) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.text = element_text(size = 14)) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
print(myplot)
ggsave(myplot,
filename = '../plots/figS4_2.pdf',
device = 'pdf',
dpi = 600,
width = 160,
height = 80,
units = 'mm',
limitsize = F)
myplot <-
ggplot(r, aes(x = rsq, fill = run)) +
geom_histogram(bins = 50,
color = 'black') +
scale_fill_manual(values = c('black', 'white'),
name = '') +
scale_x_continuous(name = expression(paste(italic(R)^2, ' predicted vs. observed')),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = 'Frequency',
expand = expansion(mult = c(0, .1))) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.text = element_text(size = 14)) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
print(myplot)
ggsave(myplot,
filename = '../plots/figS4_2.pdf',
device = 'pdf',
dpi = 600,
width = 160,
height = 80,
units = 'mm',
limitsize = F)
ggsave(myplot,
filename = '../plots/figS4_2.pdf',
device = 'pdf',
dpi = 600,
width = 160,
height = 80,
units = 'mm',
limitsize = F)
# plot FEEs in randomized data
data.rnd <- data.frame(community = data$community,
fun = sample(data$fun, size = nrow(data), replace = F))
ge_data.rnd <- makeGEdata(data)
ggplot(ge_data.rnd, aes(x = background_f.mean, xmin = background_f.mean - background_f.sd, xmax = background_f.mean + background_f.sd,
y = d_f.mean, ymin = d_f.mean - d_f.sd, ymax = d_f.mean + d_f.sd,
group = knock_in)) +
geom_abline(slope = 0, intercept = 0,
color = '#d1d3d4') +
geom_point(color = 'black',
cex = 1.5,
shape = 16) +
geom_errorbar(alpha = 0.25) +
geom_errorbarh(alpha = 0.25) +
geom_smooth(method = 'lm',
formula = y~x,
color = 'firebrick1',
se = F,
fullrange = T) +
scale_x_continuous(breaks = pretty_breaks(n = 3),
name = 'Function of ecological background [a.u.]') +
scale_y_continuous(breaks = pretty_breaks(n = 3),
name = 'dF [a.u.]') +
facet_wrap(~knock_in,
nrow = 2) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(ge_data.rnd, aes(x = background_f, y = d_f)) +
geom_abline(slope = 0, intercept = 0,
color = '#d1d3d4') +
geom_point(color = 'black',
cex = 1.5,
shape = 16) +
geom_smooth(method = 'lm',
formula = y~x,
color = 'firebrick1',
se = F,
fullrange = T) +
scale_x_continuous(breaks = pretty_breaks(n = 3),
name = 'Function of ecological background [a.u.]') +
scale_y_continuous(breaks = pretty_breaks(n = 3),
name = 'dF [a.u.]') +
facet_wrap(~knock_in,
nrow = 2) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ge_data.rnd$knock_in <- sp_names[ge_data.rnd$knock_in]
ge_data.rnd$knock_in <- factor(ge_data.rnd$knock_in, levels = c('P. cremoricolorata',
'P. putida',
'P. fulva',
'P. parafulva',
'P. savastanoi',
'E. mori',
'R. ornithinolytica',
'K. grimontii'))
ggplot(ge_data.rnd, aes(x = background_f, y = d_f)) +
geom_abline(slope = 0, intercept = 0,
color = '#d1d3d4') +
geom_point(color = 'black',
cex = 1.5,
shape = 16) +
geom_smooth(method = 'lm',
formula = y~x,
color = 'firebrick1',
se = F,
fullrange = T) +
scale_x_continuous(breaks = pretty_breaks(n = 3),
name = 'Function of ecological background [a.u.]') +
scale_y_continuous(breaks = pretty_breaks(n = 3),
name = 'dF [a.u.]') +
facet_wrap(~knock_in,
nrow = 2) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
myplot <-
ggplot(ge_data.rnd, aes(x = background_f, y = d_f)) +
geom_abline(slope = 0, intercept = 0,
color = '#d1d3d4') +
geom_point(color = 'black',
cex = 1.5,
shape = 16) +
geom_smooth(method = 'lm',
formula = y~x,
color = 'firebrick1',
se = F,
fullrange = T) +
scale_x_continuous(breaks = pretty_breaks(n = 3),
name = 'Function of ecological background [a.u.]') +
scale_y_continuous(breaks = pretty_breaks(n = 3),
name = 'dF [a.u.]') +
facet_wrap(~knock_in,
nrow = 2) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
print(myplot)
ggsave(myplot,
filename = '../plots/figS4_0.pdf',
device = 'pdf',
dpi = 600,
width = 200,
height = 100,
units = 'mm',
limitsize = F)

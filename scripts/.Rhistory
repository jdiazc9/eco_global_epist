rel_widths = c(3/4, 1/4))
print(myplot)
#plot2 <-
ggplot(r_squared, aes(x = r_squared, fill = subset, color = subset)) +
geom_histogram(aes(y = ..count../sum(..count..)),
bins = 15,
alpha = 0.75) +
scale_x_continuous(name = expression(italic(R^2)),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = '') +
scale_fill_manual(values = c('gray', 'black'),
name = 'Invasives?') +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = c(0.25, 0.75)) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
#plot2 <-
ggplot(r_squared, aes(x = r_squared, fill = subset)) +
geom_histogram(aes(y = ..count../sum(..count..)),
bins = 15,
alpha = 0.75,
color = 'black') +
scale_x_continuous(name = expression(italic(R^2)),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = '') +
scale_fill_manual(values = c('gray', 'black'),
name = 'Invasives?') +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = c(0.25, 0.75)) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
#plot2 <-
ggplot(r_squared, aes(x = r_squared, fill = subset)) +
geom_histogram(aes(y = ..count../sum(..count..)),
bins = 15,
alpha = 0.75,
color = 'black') +
scale_x_continuous(name = expression(italic(R^2)),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = '') +
scale_fill_manual(values = c('white', 'black'),
name = 'Invasives?') +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = c(0.25, 0.75)) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
plot2 <-
ggplot(r_squared, aes(x = r_squared, fill = subset)) +
geom_histogram(aes(y = ..count../sum(..count..)),
bins = 15,
alpha = 0.75,
color = 'black') +
scale_x_continuous(name = expression(italic(R^2)),
breaks = c(0, 0.5, 1),
labels = c('0', '0.5', '1')) +
scale_y_continuous(name = '') +
scale_fill_manual(values = c('white', 'black'),
name = 'Invasives?') +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = c(0.25, 0.75)) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
myplot <- plot_grid(plot1, plot2,
align = 'v',
nrow = 1,
rel_heights = c(3/4, 1/4),
rel_widths = c(3/4, 1/4))
print(myplot)
ggsave(myplot,
filename = paste('../plots/stitching_predictions_', i, '.pdf', sep = ''),
device = 'pdf',
dpi = 600,
width = 200,
height = 100,
units = 'mm',
limitsize = F)
i
source("Z:/work/micro-eco/ge_paper_v2/eco_global_epist/scripts/compare_stitching_regression.R", echo=TRUE)
ggplot(rsq, aes(x = method, y = r2, fill = interaction(method, invasives))) +
geom_bar(stat = 'identity',
width = 0.7,
position = 'dodge') +
facet_wrap(~dataset,
nrow = 1) +
scale_y_continuous(name = 'R2',
limits = c(0, 1),
breaks = pretty_breaks(n = 4)) +
#scale_fill_manual(values = c('#99d7dc', '#176766', '#b33a3b')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'bottom') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
interaction(rsq$method, rsq$invasives)
levels(interaction(rsq$method, rsq$invasives))
ggplot(rsq, aes(x = method, y = r2, fill = interaction(method, invasives))) +
geom_bar(stat = 'identity',
width = 0.7,
position = 'dodge') +
facet_wrap(~dataset,
nrow = 1) +
scale_y_continuous(name = 'R2',
limits = c(0, 1),
breaks = pretty_breaks(n = 4)) +
scale_color_manual(values = c('white', 'white', 'white',
'black', 'black', 'black')) +
#scale_fill_manual(values = c('#99d7dc', '#176766', '#b33a3b')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'bottom') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = method, y = r2, fill = interaction(method, invasives), color = interaction(method, invasives))) +
geom_bar(stat = 'identity',
width = 0.7,
position = 'dodge') +
facet_wrap(~dataset,
nrow = 1) +
scale_y_continuous(name = 'R2',
limits = c(0, 1),
breaks = pretty_breaks(n = 4)) +
scale_color_manual(values = c('white', 'white', 'white',
'black', 'black', 'black')) +
#scale_fill_manual(values = c('#99d7dc', '#176766', '#b33a3b')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'bottom') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
View(rsq)
rsq$invasives
!rsq$invasives
rsq$natives <- !rsq$invasives
ggplot(rsq, aes(x = method, y = r2, fill = interaction(method, natives), color = interaction(method, natives))) +
geom_bar(stat = 'identity',
width = 0.7,
position = 'dodge') +
facet_wrap(~dataset,
nrow = 1) +
scale_y_continuous(name = 'R2',
limits = c(0, 1),
breaks = pretty_breaks(n = 4)) +
scale_color_manual(values = c('white', 'white', 'white',
'black', 'black', 'black')) +
#scale_fill_manual(values = c('#99d7dc', '#176766', '#b33a3b')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'bottom') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = method, y = r2, fill = interaction(method, natives), color = interaction(method, natives))) +
geom_bar(stat = 'identity',
width = 0.7,
position = 'dodge') +
facet_wrap(~dataset,
nrow = 1) +
scale_y_continuous(name = 'R2',
limits = c(0, 1),
breaks = pretty_breaks(n = 4)) +
scale_color_manual(values = c('black', 'black', 'black',
'white', 'white', 'white')) +
#scale_fill_manual(values = c('#99d7dc', '#176766', '#b33a3b')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'bottom') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = method, y = r2, fill = interaction(method, natives), color = interaction(method, natives))) +
geom_bar(stat = 'identity',
width = 0.7,
position = 'dodge') +
facet_wrap(~dataset,
nrow = 1) +
scale_y_continuous(name = 'R2',
limits = c(0, 1),
breaks = pretty_breaks(n = 4)) +
scale_color_manual(values = c('#99d7dc', '#176766', '#b33a3b',
'white', 'white', 'white')) +
#scale_fill_manual(values = c('#99d7dc', '#176766', '#b33a3b')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'bottom') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = method, y = r2, fill = interaction(method, natives), color = interaction(method, natives))) +
geom_bar(stat = 'identity',
width = 0.7,
position = 'dodge') +
facet_wrap(~dataset,
nrow = 1) +
scale_y_continuous(name = 'R2',
limits = c(0, 1),
breaks = pretty_breaks(n = 4)) +
scale_color_manual(values = c('#99d7dc', '#176766', '#b33a3b',
'white', 'white', 'white')) +
scale_fill_manual(values = c('white', 'white', 'white',
'#99d7dc', '#176766', '#b33a3b')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'bottom') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = method, y = r2, fill = interaction(method, natives), color = interaction(method, natives))) +
geom_bar(stat = 'identity',
width = 0.5,
position = 'dodge') +
facet_wrap(~dataset,
nrow = 1) +
scale_y_continuous(name = 'R2',
limits = c(0, 1),
breaks = pretty_breaks(n = 4)) +
scale_color_manual(values = c('#99d7dc', '#176766', '#b33a3b',
'white', 'white', 'white')) +
scale_fill_manual(values = c('white', 'white', 'white',
'#99d7dc', '#176766', '#b33a3b')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'bottom') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggsave(filename = '../plots/stitching_vs_regression_R2.pdf',
device = 'pdf',
dpi = 600,
width = 200,
height = 150,
units = 'mm',
limitsize = F)
ggplot(rsq, aes(x = method, y = r2, fill = interaction(method, natives), color = interaction(method, natives))) +
geom_bar(stat = 'identity',
width = 0.6,
position = 'dodge') +
facet_wrap(~dataset,
nrow = 1) +
scale_y_continuous(name = 'R2',
limits = c(0, 1),
breaks = pretty_breaks(n = 4)) +
scale_color_manual(values = c('#99d7dc', '#176766', '#b33a3b',
'white', 'white', 'white')) +
scale_fill_manual(values = c('white', 'white', 'white',
'#99d7dc', '#176766', '#b33a3b')) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1.6,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'bottom') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggsave(filename = '../plots/stitching_vs_regression_R2.pdf',
device = 'pdf',
dpi = 600,
width = 200,
height = 150,
units = 'mm',
limitsize = F)
ggplot(res_full, aes(x = pred, y = obs, shape = invasives)) +
geom_abline(slope = 1,
intercept = 0,
color = '#d1d3d4') +
geom_point() +
geom_blank(data = scales_limits, aes(x = pred, y = obs)) +
scale_x_continuous(breaks = pretty_breaks(n = 3),
name = expression(paste('Predicted ', italic('F'), ' [a.u.]', sep = ''))) +
scale_y_continuous(breaks = pretty_breaks(n = 3),
name = expression(paste('Observed ', italic('F'), ' [a.u.]', sep = ''))) +
scale_shape_manual(values = c(16, 1)) +
facet_wrap(method~dataset,
scales = 'free',
nrow = 3) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(res_full, aes(x = pred, y = obs, shape = invasives)) +
geom_abline(slope = 1,
intercept = 0,
color = '#d1d3d4') +
geom_point(cex = 2) +
geom_blank(data = scales_limits, aes(x = pred, y = obs)) +
scale_x_continuous(breaks = pretty_breaks(n = 3),
name = expression(paste('Predicted ', italic('F'), ' [a.u.]', sep = ''))) +
scale_y_continuous(breaks = pretty_breaks(n = 3),
name = expression(paste('Observed ', italic('F'), ' [a.u.]', sep = ''))) +
scale_shape_manual(values = c(16, 1)) +
facet_wrap(method~dataset,
scales = 'free',
nrow = 3) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggsave(filename = '../plots/stitching_vs_regression.pdf',
device = 'pdf',
dpi = 600,
width = 300,
height = 200,
units = 'mm',
limitsize = F)
ggplot(res_full, aes(x = pred, y = obs, shape = invasives)) +
geom_abline(slope = 1,
intercept = 0,
color = '#d1d3d4') +
geom_point(cex = 3) +
geom_blank(data = scales_limits, aes(x = pred, y = obs)) +
scale_x_continuous(breaks = pretty_breaks(n = 3),
name = expression(paste('Predicted ', italic('F'), ' [a.u.]', sep = ''))) +
scale_y_continuous(breaks = pretty_breaks(n = 3),
name = expression(paste('Observed ', italic('F'), ' [a.u.]', sep = ''))) +
scale_shape_manual(values = c(16, 1)) +
facet_wrap(method~dataset,
scales = 'free',
nrow = 3) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 1,
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggsave(filename = '../plots/stitching_vs_regression.pdf',
device = 'pdf',
dpi = 600,
width = 300,
height = 200,
units = 'mm',
limitsize = F)
source("Z:/work/micro-eco/ge_paper_v2/eco_global_epist/scripts/compare_stitching_regression.R", echo=TRUE)

theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 0.6,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = 0, y = rsq)) +
geom_jitter(size = 3) +
facet_wrap(~data_set, nrow = 1) +
scale_x_continuous(name = '',
limits = c(-0.75, 0.75)) +
scale_y_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = 0, y = rsq)) +
geom_jitter(size = 3) +
facet_wrap(~data_set, nrow = 1) +
scale_x_continuous(name = '',
limits = c(-0.75, 0.75)) +
scale_y_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = 0, y = rsq)) +
geom_jitter(size = 3) +
facet_wrap(~data_set, nrow = 1) +
scale_x_continuous(name = '',
limits = c(-0.75, 0.75)) +
scale_y_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = 0, y = rsq)) +
geom_jitter(size = 3) +
facet_wrap(~data_set, nrow = 1) +
scale_x_continuous(name = '',
limits = c(-0.75, 0.75)) +
scale_y_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = 0, y = rsq)) +
geom_jitter(size = 3) +
facet_wrap(~data_set, nrow = 1) +
scale_x_continuous(name = '',
limits = c(-0.75, 0.75)) +
scale_y_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = 0, y = rsq)) +
geom_jitter(size = 3) +
facet_wrap(~data_set, nrow = 1) +
scale_x_continuous(name = '',
limits = c(-0.75, 0.75)) +
scale_y_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = rsq)) +
geom_histogram()
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20)
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip()
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = '',
limits = c(-0.75, 0.75)) +
scale_y_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_y_continuous(name = '',
limits = c(-0.75, 0.75)) +
scale_x_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = '',
limits = c(-0.75, 0.75)) +
scale_y_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip()
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = '',
limits = c(-0.2, 1.2))
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = '',
limits = c(0, 1))
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = '',
limits = c(-0.2, 1.2))
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(-0.2, 1.2)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(-0.2, 1.2))
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = expression(paste(italic(R)^2, ' of FEE'))) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = expression(paste(italic(R)^2, ' of FEE'))) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = expression(paste(italic(R)^2, ' of FEE'))) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5)
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = expression(paste(italic(R)^2, ' of FEE'))) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf,size=0.5)
myplot <- grid.arrange(myplot1, myplot2, nrow = 1)
myplot1 <-
ggplot(rsq, aes(x = 0, y = rsq)) +
geom_jitter(size = 3) +
facet_wrap(~data_set, nrow = 1) +
scale_x_continuous(name = '',
limits = c(-0.75, 0.75)) +
scale_y_continuous(name = expression(paste(italic(R)^2, ' of FEE')),
limits = c(0, 1)) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf, size=0.5) +
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf,size=0.5) +
annotate("segment", x=-Inf, xend=Inf, y=Inf, yend=Inf, size=0.5) +
annotate("segment", x=Inf, xend=Inf, y=-Inf, yend=Inf,size=0.5)
myplot2 <-
ggplot(rsq, aes(x = rsq)) +
geom_histogram(bins = 20) +
coord_flip() +
scale_x_continuous(name = expression(paste(italic(R)^2, ' of FEE'))) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = 'italic',
size = 10),
aspect.ratio = 3,
axis.text = element_text(size = 14),
axis.title = element_text(size = 18),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = 'none') +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf,size=0.5)
myplot <- grid.arrange(myplot1, myplot2, nrow = 1)
library(cowplot)
myplot <- plot_grid(myplo1, myplot2, rel_widths = c(5/6, 1/6))
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(5/6, 1/6))
print(myplot)
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(4/6, 2/6))
print(myplot)
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(9/12, 3/12))
print(myplot)
r <- 0.75
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(r, 1-r))
print(myplot)
r <- 0.8
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(r, 1-r))
print(myplot)
r <- 0.78
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(r, 1-r))
print(myplot)
r <- 0.785
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(r, 1-r))
print(myplot)
r <- 0.775
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(r, 1-r))
print(myplot)
ggsave(myplot,
filename = '../plots/figS0.5.pdf',
device = 'pdf',
dpi = 600,
width = 200,
height = 100,
units = 'mm',
limitsize = F)
r <- 5/6
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(r, 1-r))
print(myplot)
ggsave(myplot,
filename = '../plots/figS0.5.pdf',
device = 'pdf',
dpi = 600,
width = 200,
height = 100,
units = 'mm',
limitsize = F)
r <- 0.7
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(r, 1-r))
print(myplot)
ggsave(myplot,
filename = '../plots/figS0.5.pdf',
device = 'pdf',
dpi = 600,
width = 200,
height = 100,
units = 'mm',
limitsize = F)
ggsave(myplot,
filename = '../plots/figS0.5.pdf',
device = 'pdf',
dpi = 600,
width = 200,
height = 100,
units = 'mm',
limitsize = F)
r <- 0.75
myplot <- plot_grid(myplot1, myplot2, rel_widths = c(r, 1-r))
print(myplot)
ggsave(myplot,
filename = '../plots/figS0.5.pdf',
device = 'pdf',
dpi = 600,
width = 200,
height = 100,
units = 'mm',
limitsize = F)
slopes
View(ge_data)
# distribution of slopes
slopes <- NULL
n
lm(d_f ~ background_f, data = ge_data[n, ])
lm(d_f ~ background_f, data = ge_data[n, ])$Coefficients
lm(d_f ~ background_f, data = ge_data[n, ])$coefficients
lm(d_f ~ background_f, data = ge_data[n, ])$coefficients[2]
source("C:/Users/Juan/Desktop/ge_paper/eco_global_epist/scripts/fig1.R", echo=TRUE)
warnings()
rsq$slope
hist(rsq$slope)
plot(runif(nrow(rsq)), rsq$slope)
mean(rsq$slope)
sum(rsq$slope>0.5)/nrow(rsq)
sum(rsq$slope>0.1)/nrow(rsq)
sum(rsq$slope>0.0)/nrow(rsq)
sum(rsq$slope>0.1)/nrow(rsq)
View(rsq)
sum(rsq$slope>0.3)/nrow(rsq)
sum(rsq$slope<-0.3)/nrow(rsq)
rsq <- data.frame(data_set = character(0),
species = character(0),
rsq = numeric(0),
slope = numeric(0))
for (ds in data_sets) {
for (sp in unique(ge_data$knock_in[ge_data$data_set == ds])) {
n <- ge_data$data_set == ds & ge_data$knock_in == sp
rsq <- rbind(rsq,
data.frame(data_set = ds,
species = sp,
rsq = cor(ge_data$background_f[n], ge_data$d_f[n])^2,
slope = lm(d_f ~ background_f, data = ge_data[n, ])$coefficients[2]))
}
}
rsq$species[rsq$species == 'P-1'] <- 'P'
rsq$data_set <- factor(rsq$data_set, levels = data_sets[c(4, 3, 5, 1, 2)])
sum(rsq$slope<c(-0.3))/nrow(rsq)
mean(rsq$rsq)
sum(rsq$slope>0.3)/nrow(rsq)
